var players={};function pauseMainBanner(){$(".top_slider_wrapp .flexslider").flexslider("pause")}function playMainBanner(){$(".top_slider_wrapp .flexslider").flexslider("play")}function startMainBannerSlideVideo(e){var o=e.attr("data-slide_index"),a=e.closest(".slides").find('.box[data-slide_index="'+o+'"]');if(e.attr("data-video_source")){a.addClass("loading"),pauseMainBanner();var l=e.attr("data-video_src"),d=1==e.attr("data-video_disable_sound"),s=1==e.attr("data-video_loop"),p=1==e.attr("data-video_cover")&&!isMobile,y=(e.attr("data-video_under_text"),e.attr("data-video_player")),c="YOUTUBE"===y,u="VIMEO"===y,w="RUTUBE"===y,f="HTML5"===y;if(l&&!e.find(".video").length){var r=function(){a.each(function(e,a){var r=$(a),i=getRandomInt(100,1e3),n=r.hasClass("clone"),t=r.attr("id");r.find(".video."+t).length||(c?r.prepend('<iframe id="player_'+i+'" class="video '+t+(p?" cover":"")+'" src="'+l+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay"></iframe>'):u?r.prepend('<iframe id="player_'+i+'" class="video '+t+(p?" cover":"")+'" src="'+l+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay"></iframe>'):w?(l=l+"&playerid="+i,r.prepend('<iframe id="player_'+i+'" class="video '+t+(p?" cover":"")+'" src="'+l+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay"></iframe>')):f&&r.prepend('<video autobuffer playsinline webkit-playsinline autoplay id="player_'+i+'" class="video '+t+(p?" cover":"")+'"'+(s?" loop ":"")+(d||n?" muted ":"")+'><source src="'+l+'" type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\' /><p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that supports HTML5 video</p></iframe>')),void 0!==players&&players&&(players[i]={id:"player_"+i,mute:d||n,loop:s,cover:p,videoPlayer:y,slideIndex:o,clone:n,playing:!1},c?window[players[i].id]=new YT.Player(players[i].id,{events:{onReady:onYoutubePlayerReady,onStateChange:onYoutubePlayerStateChange}}):u?(window[players[i].id]=new Vimeo.Player(document.getElementById(players[i].id),{autopause:!1,byline:!1,loop:!1,title:!1}),window[players[i].id].on("loaded",onVimeoPlayerReady),window[players[i].id].on("play",onVimeoPlayerStateChange),window[players[i].id].on("pause",onVimeoPlayerStateChange),window[players[i].id].on("ended",onVimeoPlayerStateChange)):w?document.getElementById(players[i].id).onload=function(e){var a=this.id.replace("player_","");players[a].contentWindow=this.contentWindow,onRutubePlayerReady(a)}:f&&(document.getElementById(players[i].id).addEventListener("loadeddata",onHtml5PlayerReady),document.getElementById(players[i].id).addEventListener("play",onHtml5PlayerStateChange),document.getElementById(players[i].id).addEventListener("pause",onHtml5PlayerStateChange),document.getElementById(players[i].id).addEventListener("ended",onHtml5PlayerStateChange)))})};if(f)r();else{var i="",n="";if(void 0===window.YoutubePlayerScriptLoaded&&(window.YoutubePlayerScriptLoaded=!1),void 0===window.VimeoPlayerScriptLoaded&&(window.VimeoPlayerScriptLoaded=!1),void 0===window.RutubePlayerListnersAdded&&(window.RutubePlayerListnersAdded=!1),c){if(i="YT",n="Player",!window.YoutubePlayerScriptLoaded){(v=document.createElement("script")).src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(v,t),window.YoutubePlayerScriptLoaded=!0}}else if(u){var v;if(i="Vimeo",!window.VimeoPlayerScriptLoaded)(v=document.createElement("script")).src="https://player.vimeo.com/api/player.js",(document.head||document.documentElement).appendChild(v),window.VimeoPlayerScriptLoaded=!0}else w&&(window.RutubePlayerListnersAdded||window.addEventListener("message",function(e){if(-1!==e.origin.indexOf("rutube.ru")){var a=JSON.parse(e.data);if("object"==typeof a&&a&&void 0!==a.type&&a.type){var r=!1;for(var i in players)if(void 0!==players[i].contentWindow&&players[i].contentWindow==e.source){r=i;break}if(r)switch(a.type){case"player:changeState":onRutubePlayerStateChange(r,a.data.state);break;case"player:currentTime":onRutubePlayerCurrentTime(r,a.data.time)}}}}));if(i.length)if("object"==typeof window[i])(!n.length||n.length&&"function"==typeof window[i][n])&&r();else var g=setInterval(function(){"object"==typeof window[i]&&(!n.length||n.length&&"function"==typeof window[i][n])&&(clearInterval(g),r())},50);else r()}}else if(void 0!==players&&players)for(var m in players)players[m].clone||"object"==typeof window[players[m].id]&&(players[m].playing?"YOUTUBE"===players[m].videoPlayer?window[players[m].id].pauseVideo():"VIMEO"===players[m].videoPlayer?window[players[m].id].pause():"RUTUBE"===players[m].videoPlayer?document.getElementById(players[m].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[m].videoPlayer&&document.getElementById(players[m].id).pause():players[m].slideIndex==o&&("YOUTUBE"===players[m].videoPlayer?window[players[m].id].playVideo():"VIMEO"===players[m].videoPlayer?window[players[m].id].play():"RUTUBE"===players[m].videoPlayer?document.getElementById(players[m].id).contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):"HTML5"===players[m].videoPlayer&&document.getElementById(players[m].id).play()))}}var CoverPlayerHtml=function(e){if($(".video.cover").length){var a=$('.box[data-slide_index="'+e+'"]'),r=$(".top_slider_wrapp").height(),i=$(".top_slider_wrapp").width(),n=$(".top_slider_wrapp video").outerHeight(),t=$(".top_slider_wrapp video").outerWidth();if(n<=r&&i<=t?(a.find("video.cover").height(r+(jQuery.browser.mobile?30:0)).width("auto"),a.hasClass("wvideo")&&a.css("background-position-x","auto")):r<n&&t<i&&(a.find("video.cover").width(i).height("auto"),a.hasClass("wvideo")&&a.css("background-position-y","auto")),a.find("video.cover").length){a.find("video.cover").css("margin-top",-n/2);$(".top_slider_wrapp video").width()}setTimeout(function(){$(".video.cover").css("visibility","visible")},1300)}},CoverPlayer=function(){var e=$(".video.cover");if(e.length){var a=$(".top_slider_wrapp").height(),r=($(".top_slider_wrapp").width(),9*$(window).width()/16);e.css({height:r+"px","margin-top":(a-r)/2+"px"})}};function onYoutubePlayerReady(e){var a=e.target.a.id.replace("player_","");if(a){var r=players[a].mute,i=players[a].cover,n=players[a].clone;(r||n)&&window[players[a].id].mute(),i&&CoverPlayer(),n?setTimeout(function(){e.target.pauseVideo()},100):(pauseMainBanner(),e.target.playVideo()),$("#player_"+a).closest(".box").addClass("started")}}function onYoutubePlayerStateChange(e){var a=e.target.a.id.replace("player_","");if(a){var r=players[a].clone,i=players[a].loop,n=players[a].slideIndex;if(!r)if(e.data===YT.PlayerState.PLAYING)players[a].playing=!0,$("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),pauseMainBanner(),e.target.playVideo();else if(e.data===YT.PlayerState.PAUSED){players[a].playing=!1;var t=Math.floor(10*window[players[a].id].getCurrentTime())/10;for(var o in $("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),window[players[a].id].seekTo(t,!0),players)players[o].slideIndex==n&&players[o].clone&&"getCurrentTime"in window[players[o].id]&&(window[players[o].id].pauseVideo(),window[players[o].id].seekTo(t,!0))}else e.data===YT.PlayerState.ENDED&&(players[a].playing=!1,i?e.target.playVideo():playMainBanner())}}function onVimeoPlayerReady(e){var a=this.element.id.replace("player_","");if(a){var r=players[a].mute,i=players[a].cover,n=players[a].clone;(r||n)&&window[players[a].id].setVolume(0),i&&CoverPlayer(),n?setTimeout(function(){window[players[a].id].pause()},100):(pauseMainBanner(),window[players[a].id].play()),$("#player_"+a).closest(".box").addClass("started")}}function onVimeoPlayerStateChange(e){var a=this.element.id.replace("player_","");if(a){players[a].cover;var r=players[a].clone,i=players[a].loop,n=players[a].slideIndex;r||window[players[a].id].getPaused().then(function(e){e?(players[a].playing=!1,$("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),window[players[a].id].getCurrentTime().then(function(e){var r=Math.floor(10*e)/10;window[players[a].id].setCurrentTime(r).then(function(e){for(var a in players)players[a].slideIndex==n&&players[a].clone&&(window[players[a].id].pause(),window[players[a].id].setCurrentTime(r).then(function(e){}))})})):($("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),window[players[a].id].getEnded().then(function(e){e?(players[a].playing=!1,i?window[players[a].id].play():playMainBanner()):(players[a].playing=!0,pauseMainBanner())}))})}}function onRutubePlayerReady(e){if(e){var a=players[e].mute,r=players[e].cover,i=players[e].clone,n=document.getElementById(players[e].id);(a||i)&&n.contentWindow.postMessage(JSON.stringify({type:"player:mute",data:{}}),"*"),r&&CoverPlayer(),i?setTimeout(function(){n.contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*")},100):(pauseMainBanner(),n.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*")),$("#player_"+e).closest(".box").addClass("started")}}function onRutubePlayerCurrentTime(e,a){e&&(players[e].time=a)}function onRutubePlayerStateChange(e,a){if(e){var r=players[e].clone,i=players[e].loop,n=players[e].slideIndex,t=document.getElementById(players[e].id);if(!r)if("playing"===a)$("#"+e).closest(".box").find(".wrapper_inner").addClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),players[e].playing=!0,pauseMainBanner();else if("paused"===a){$("#"+e).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),players[e].playing=!1;var o=Math.floor(10*players[e].time)/10;for(var l in t.contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:o}}),"*"),players)players[l].slideIndex==n&&players[l].clone&&(document.getElementById(players[l].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"),document.getElementById(players[l].id).contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:o}}),"*"))}else"stopped"===a&&($("#"+e).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),players[e].playing=!1,i?t.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):playMainBanner())}}function onHtml5PlayerReady(e){var a=e.target.id.replace("player_","");if(a){var r=players[a].mute,i=players[a].cover,n=players[a].clone;(r||n)&&$("#"+players[a].id).prop("muted",!0),i&&CoverPlayer(),n?e.target.pause():(pauseMainBanner(),e.target.play()),$("#player_"+a).closest(".box").addClass("started")}}function onHtml5PlayerStateChange(e){var a=e.target.id.replace("player_","");if(a){players[a].cover;var r=players[a].clone,i=players[a].loop,n=players[a].slideIndex;if(!r)if(e.target.paused){players[a].playing=!1,$("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading");var t=Math.floor(10*e.target.currentTime)/10;for(var o in e.target.currentTime=t,players)players[o].slideIndex==n&&players[o].clone&&(document.getElementById(players[o].id).pause(),document.getElementById(players[o].id).currentTime=t)}else e.target.ended?(players[a].playing=!1,i?($("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),e.target.play()):playMainBanner()):(players[a].playing=!0,$("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),pauseMainBanner())}}waitYTPlayer=function(e,a){"undefined"!=typeof YT&&YT&&YT.Player?"function"==typeof a&&a():setTimeout(function(){waitYTPlayer(e,a)},e)},$(document).on("click","video.video",function(e){var a=e.target.id.replace("player_","");a&&players[a].playing&&e.target.pause()}),$(".top_slider_wrapp .box .wrapper_inner").on("click",function(e){$(e.target).hasClass("btn-video")||($(this).hasClass("loading")&&(e.stopPropagation(),$(this).find(".btn-video").trigger("click")),$(this).closest(".box").data("video_autoplay")&&startMainBannerSlideVideo($(this).closest(".box")))}),$(document).on("click",".top_slider_wrapp .box.wvideo",function(){$(this).find(".btn-video").trigger("click")}),$(document).on("click",".top_slider_wrapp .box .btn-video",function(e){e.stopPropagation(),$(this).hasClass("loading")?($(this).removeClass("loading"),$(this).closest(".wrapper_inner").removeClass("loading")):($(this).addClass("loading"),$(this).closest(".wrapper_inner").addClass("loading")),startMainBannerSlideVideo($(this).closest(".box"))}),getRandomInt=function(e,a){return Math.floor(Math.random()*(a-e))+e},BX.addCustomEvent("onSlideEnd",function(e){try{if(ignoreResize.push(!0),e)e.slider&&setTimeout(function(){$(".banners-big.front .btn-video, .banners-big.front .box").removeClass("loading")},300)}catch(e){}finally{ignoreResize.pop()}});var ignoreResize=[];BX.addCustomEvent("onSlide",function(e){try{if(ignoreResize.push(!0),e){var a=e.slider;if(a){var r=a.find(".box.flex-active-slide"),i=r.attr("data-slide_index");if(void 0!==i&&i.length){if(setTimeout(function(){CoverPlayerHtml(i)},200),void 0!==players&&players)for(var n in players)players[n].playing&&!players[n].clone&&players[n].slideIndex!=i&&"object"==typeof window[players[n].id]&&("YOUTUBE"===players[n].videoPlayer?window[players[n].id].pauseVideo():"VIMEO"===players[n].videoPlayer?window[players[n].id].pause():"RUTUBE"===players[n].videoPlayer?document.getElementById(players[n].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[n].videoPlayer&&document.getElementById(players[n].id).pause());1==r.attr("data-video_autoplay")&&startMainBannerSlideVideo(r)}if(r.find("video").length&&!r.find(".btn-video").length){var t=r.find("video").attr("id");document.getElementById(t).play()}}}}catch(e){}finally{ignoreResize.pop()}});